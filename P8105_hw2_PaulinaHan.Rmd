---
title: "P8105_hw2_PaulinaHan"
author: "Paulina Han"
date: "2021/10/1"
output: github_document
---

```{r, echo=FALSE, message=FALSE}
library(tidyverse)
library(readxl)
library(haven)
```

# Problem 1
```{r, warning=FALSE}
trash_df = read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = "Mr. Trash Wheel",range = cell_cols("A:N")) #rows?

#tidying trash data set
trash_tidy = 
  trash_df %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  rename(weight = weight_tons ,volume = volume_cubic_yards) %>% 
  mutate(sports_balls = round(sports_balls,0))

#2019 precipitation
precipitation19_df = read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",sheet = "2019 Precipitation", range = "A2:B14")

#tidy 2019 precipitation data
tidy_2019_df =
  precipitation19_df %>% 
  janitor::clean_names() %>% 
  drop_na(total) %>% 
  mutate(year = 2019)
  
#2018 precipitation
precipitation18_df = read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",sheet = "2018 Precipitation", range = "A2:B14")

#tidy 2018 precipitation data
tidy_2018_df =
  precipitation19_df %>% 
  janitor::clean_names() %>% 
  drop_na(total) %>% 
  mutate(year = 2018)  

#combine precipitation data set
preciptation = 
  bind_rows(tidy_2018_df,tidy_2019_df) %>% 
 mutate(month=month.name[month])

#description 
#data set 1
ncol_trash_tidy = ncol(trash_tidy)
nrow_trash_tidy = nrow(trash_tidy)

mean_weight = mean(pull(trash_tidy,weight))
max_weight = max(pull(trash_tidy,weight))
min_weight = min(pull(trash_tidy,weight))

mean_volume = mean(pull(trash_tidy,volume))
max_volume = max(pull(trash_tidy,volume))
min_volume = min(pull(trash_tidy,volume))
#data set 2
ncol_preciptation = ncol(preciptation)
nrow_preciptation = nrow(preciptation)

max_rain = max(pull(preciptation,total))

#median of sports ball in 2017
ball =
  trash_tidy %>% 
  filter(year==2017) %>% 
  pull(sports_balls) %>% 
  median()

```

The tidied Mr.Wheel Trash data set has `r ncol_trash_tidy` columns and `r nrow_trash_tidy ` rows. The mean weight of trash the dumpster took is `r mean_weight` and the maximum weight of trash the dumpster took is `r max_weight`, the minimum weight of trash the dumpster took is `r min_weight`. The mean volume of trash the dumpster took is `r mean_volume`, the maximum volume of trash the dumpster took is `r max_volume` and the minimum volume of trash the dumpster took is `r min_volume`.

The precipitation data set including 2018 and 2019 has `r ncol_preciptation` columns and `r nrow_preciptation` rows. 2018 March had the most preciptation in 2018 and 2019 which is `r max_rain`.

the median number of sports balls in a dumpster in 2017 is `r ball`.

# Problem 2
```{r}
#read pols-month.csv
pols = read_csv("./data/fivethirtyeight_datasets/fivethirtyeight_datasets/pols-month.csv")

#clean pols-month data
pols_tidy = 
  pols %>% 
  janitor::clean_names() %>% 
  separate(mon, into = c("year","month","day")) %>% 
  mutate(month=month.name[as.numeric(month)]) 

#create a new vector president
president = c()  
for(i in 1:822){
  if(pols_tidy$prez_dem[i] == 1){
    president[i] = 'dem'
  }else{
    president[i] = 'gop'
  }
}
#binding president with pols data
pols_tidy = bind_cols(pols_tidy,president) 
colnames(pols_tidy) = c(colnames(pols_tidy[1:11]),'president')
#final data
pols_tidy = select(pols_tidy,-day)

#read snp.csv
snp = read_csv("./data/fivethirtyeight_datasets/fivethirtyeight_datasets/snp.csv")

#clean pols-month data
snp_tidy = 
 snp %>% 
  janitor::clean_names() %>% 
  separate(date, into = c("day","month","year")) %>% 
  mutate(month=month.name[as.numeric(month)]) %>% 
  relocate(year,month) %>% 
  select(-day)  
#adding year
snp_tidy$year = as.numeric(snp_tidy$year)
for(i in 1:187){
  snp_tidy$year[i] = snp_tidy$year[i]+2000
} 
for(i in 188:787){
   snp_tidy$year[i] = snp_tidy$year[i]+1900
  }
 

#read unemployment data
unemployment = read.csv("./data/fivethirtyeight_datasets/fivethirtyeight_datasets/unemployment.csv")

#clean unemployment data
une_tidy = 
  unemployment %>% 
   janitor::clean_names() %>% 
  pivot_longer(
    unemployment$Jan: unemployment$Dec,
    names_to = "month", 
    values_to = "unemploy")

  
  

```



# Problem 3

```{r}
#read baby names data
baby = read_csv("./data/Popular_Baby_Names.csv")

#tidy baby data set
baby_tidy = 
   baby %>% 
   janitor::clean_names() %>% 
   mutate(gender = str_to_lower(gender), ethnicity = str_to_lower(ethnicity), childs_first_name = str_to_lower(childs_first_name)) %>% 
  mutate(
    ethnicity=replace(ethnicity,ethnicity == 'asian and paci','asian and pacific islander'),
     ethnicity=replace(ethnicity,ethnicity == 'black non hisp','black non hispanic'),
    ethnicity=replace(ethnicity,ethnicity == 'white non hisp','white non hispanic') ) %>% 
  distinct()

# show Olivia's population in times

Olivia = 
  baby_tidy %>% 
  filter(childs_first_name == 'olivia') %>% 
  select(year_of_birth, ethnicity, rank) %>% 
  pivot_wider(
  names_from = "year_of_birth", 
  values_from = "rank") %>% 
relocate(ethnicity,'2011','2012','2013','2014','2015','2016') %>% 
 knitr::kable()

Olivia

#male popular name 
boy =
  baby_tidy %>% 
  filter(gender == 'male') %>% 
  filter(childs_first_name == "Ethan") %>% 
select(year_of_birth, ethnicity, rank) %>% 
  pivot_wider(
  names_from = "year_of_birth", 
  values_from = "rank") %>% 
relocate(ethnicity,'2013','2014','2015','2016') %>% 
 knitr::kable()
#Ethan
boy

#scatter plot 
boy_2016_df = 
  baby_tidy %>% 
  filter(year_of_birth == 2016, gender == 'male', ethnicity == 'white non hispanic') 
  
ggplot(boy_2016_df, aes(x = rank, y = count )) + geom_point()

#new data set
new = 
baby_tidy %>% 
  filter(gender == 'male') %>% 
  select(childs_first_name,rank,count,year_of_birth) %>% 
  group_by(childs_first_name)%>% 
  filter(childs_first_name == 'ethan')
  
```

